<!DOCTYPE html>
<html lang="en">
    <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>
    
        [ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기
    
</title>
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>[ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기 | Gimin’s Blog</title>
<meta name="generator" content="Jekyll v4.4.1">
<meta property="og:title" content="[ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기">
<meta property="og:locale" content="en_US">
<meta name="description" content="[ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기">
<meta property="og:description" content="[ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기">
<link rel="canonical" href="http://localhost:4000/Architecture/Domain%20Design/oneco-ddd-dailycontent-2.html">
<meta property="og:url" content="http://localhost:4000/Architecture/Domain%20Design/oneco-ddd-dailycontent-2.html">
<meta property="og:site_name" content="Gimin’s Blog">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2025-12-12T17:30:00+09:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="[ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-12-12T17:30:00+09:00","datePublished":"2025-12-12T17:30:00+09:00","description":"[ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기","headline":"[ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/Architecture/Domain%20Design/oneco-ddd-dailycontent-2.html"},"url":"http://localhost:4000/Architecture/Domain%20Design/oneco-ddd-dailycontent-2.html"}</script>
<!-- End Jekyll SEO tag -->


<link rel="shortcut icon" type="image/png" href="/assets/img/favicon.webp">
<style>
@font-face {
    font-family: 'Nunito Sans';
    font-style: normal;
    font-weight: 400;
    font-display: optional;
    src: local('Nunito Sans'),
         url("/assets/fonts/NunitoSans-Regular.woff2") format("woff2");
}

@font-face {
    font-family: 'Righteous';
    font-style: normal;
    font-weight: 600;
    font-display: optional;
    src: local('Righteous'),
         url("/assets/fonts/Righteous-Regular.woff2") format("woff2");
}

@font-face {
    font-family: 'Lato';
    font-style: normal;
    font-weight: 400;
    font-display: optional;
    src: local('Lato'),
         url("/assets/fonts/Lato-Regular.woff2") format("woff2");
}
</style>

<script src="/assets/js/fontfaceobserver.js" type="text/javascript"></script>
<script type="text/javascript">
    const nunitoObserver = new FontFaceObserver('Nunito Sans');
    const righteousObserver = new FontFaceObserver('Righteous');
    const latoObserver = new FontFaceObserver('Lato');
  
    Promise.all([
        nunitoObserver.load(),
        righteousObserver.load(),
        latoObserver.load(),
    ]).then(function(){
        document.documentElement.className += " fonts-loaded";
    });
</script>

<meta name="baseurl" content="">
<meta name="description" content="시스템 설계와 깊게 공부하는 것을 좋아하는 개발자의 블로그입니다.">

        <link rel="preload" href="/assets/img/profile.jpg" as="image">
        <link rel="stylesheet" href="/assets/css/style.css">
        
            

            <meta name="giscus_repo" content="">
            <meta name="giscus_repoId" content="">
            <meta name="giscus_category" content="">
            <meta name="giscus_categoryId" content="">

            
                <style>
                        .thumbnail {
                            background-image: url("/assets/img/thumbnail/oneco-ddd-dailycontent.png");
                        }
                    
                </style>
            
        
    </head>
    <body>
        <script type="text/javascript">
            let currentTheme = localStorage.getItem('theme');
        
            document.body.classList[currentTheme === 'dark' ? 'add' : 'remove']('dark-theme');
        </script>
        <canvas id="stars" width="100%" height="100%"></canvas>
        <div class="sidebar sidebar-left">
    <div class="side-banner">
        <h1 class="site-tab">
            <a href="/" class="site-name">
                <img src="/assets/img/icon/house.webp" alt="" loading="lazy">
                <mark>Gimin's Blog</mark>
            </a>
            <button id="btn-brightness" aria-label="brightness-button">
                <svg class="ico-dark" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512"><path d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"></path></svg>
                <svg class="ico-light" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"></path></svg>
            </button>
            <button id="btn-search" aria-label="search-button">
                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"></path></svg>
            </button>
            <button id="btn-nav" aria-pressed="false" aria-label="menu-button">
                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
            </button>
        </h1>
        <a href="/" class="site-avatar" aria-label="site-avatar">
            <img src="/assets/img/profile.jpg" loading="lazy" alt="homepage" aria-label="homepage-button">
        </a>
    </div>
    <div class="side-info">
        <nav id="navigation">
    
    
    

    

        
    

        
    

        
    

        
    

        
    

        
    

        
    

        
    

        
    

        
    
            
            
            
            
            
            
            
            
            
            
            
            
            
            

    
    
    

    <ul class="nav-list">
<li id="nav-first" aria-label="Architecture">
            <div class="nav-item">
                <a href="/Architecture/" class="nav-list-link nav-lh">
                    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M181.3 32.4c17.4 2.9 29.2 19.4 26.3 36.8L197.8 128h95.1l11.5-69.3c2.9-17.4 19.4-29.2 36.8-26.3s29.2 19.4 26.3 36.8L357.8 128H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H347.1L325.8 320H384c17.7 0 32 14.3 32 32s-14.3 32-32 32H315.1l-11.5 69.3c-2.9 17.4-19.4 29.2-36.8 26.3s-29.2-19.4-26.3-36.8l9.8-58.7H155.1l-11.5 69.3c-2.9 17.4-19.4 29.2-36.8 26.3s-29.2-19.4-26.3-36.8L90.2 384H32c-17.7 0-32-14.3-32-32s14.3-32 32-32h68.9l21.3-128H64c-17.7 0-32-14.3-32-32s14.3-32 32-32h68.9l11.5-69.3c2.9-17.4 19.4-29.2 36.8-26.3zM187.1 192L165.8 320h95.1l21.3-128H187.1z"></path></svg>
                    <span>Architecture</span>
                </a><button class="nav-list-expander" aria-label="toggle items in Architecture category" aria-pressed="false">
                    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg>
                </button>
</div>
<ul class="nav-list">
<li id="nav-second" aria-label="Domain Design">
                    <div class="nav-item">
                        <a href="/Architecture/Domain%20Design/" class="nav-list-link nav-sh">
                            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"></path></svg>
                            <span>Domain Design</span>
                        </a>
</div>
</li>
<li id="nav-second" aria-label="System Design">
                    <div class="nav-item">
                        <a href="/Architecture/System%20Design/" class="nav-list-link nav-sh">
                            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"></path></svg>
                            <span>System Design</span>
                        </a>
</div>
</li>
<li id="nav-second" aria-label="data-modeling-erd">
                    <div class="nav-item">
                        <a href="/Architecture/data-modeling-erd/" class="nav-list-link nav-sh">
                            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"></path></svg>
                            <span>data-modeling-erd</span>
                        </a>
</div>
</li>
<li id="nav-second" aria-label="security-auth">
                    <div class="nav-item">
                        <a href="/Architecture/security-auth/" class="nav-list-link nav-sh">
                            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"></path></svg>
                            <span>security-auth</span>
                        </a>
</div>
</li>
</ul>
</li>
<li id="nav-first" aria-label="Java">
            <div class="nav-item">
                <a href="/Java/" class="nav-list-link nav-lh">
                    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M181.3 32.4c17.4 2.9 29.2 19.4 26.3 36.8L197.8 128h95.1l11.5-69.3c2.9-17.4 19.4-29.2 36.8-26.3s29.2 19.4 26.3 36.8L357.8 128H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H347.1L325.8 320H384c17.7 0 32 14.3 32 32s-14.3 32-32 32H315.1l-11.5 69.3c-2.9 17.4-19.4 29.2-36.8 26.3s-29.2-19.4-26.3-36.8l9.8-58.7H155.1l-11.5 69.3c-2.9 17.4-19.4 29.2-36.8 26.3s-29.2-19.4-26.3-36.8L90.2 384H32c-17.7 0-32-14.3-32-32s14.3-32 32-32h68.9l21.3-128H64c-17.7 0-32-14.3-32-32s14.3-32 32-32h68.9l11.5-69.3c2.9-17.4 19.4-29.2 36.8-26.3zM187.1 192L165.8 320h95.1l21.3-128H187.1z"></path></svg>
                    <span>Java</span>
                </a>
</div>
</li>
<li id="nav-first" aria-label="Spring Boot">
            <div class="nav-item">
                <a href="/Spring%20Boot/" class="nav-list-link nav-lh">
                    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M181.3 32.4c17.4 2.9 29.2 19.4 26.3 36.8L197.8 128h95.1l11.5-69.3c2.9-17.4 19.4-29.2 36.8-26.3s29.2 19.4 26.3 36.8L357.8 128H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H347.1L325.8 320H384c17.7 0 32 14.3 32 32s-14.3 32-32 32H315.1l-11.5 69.3c-2.9 17.4-19.4 29.2-36.8 26.3s-29.2-19.4-26.3-36.8l9.8-58.7H155.1l-11.5 69.3c-2.9 17.4-19.4 29.2-36.8 26.3s-29.2-19.4-26.3-36.8L90.2 384H32c-17.7 0-32-14.3-32-32s14.3-32 32-32h68.9l21.3-128H64c-17.7 0-32-14.3-32-32s14.3-32 32-32h68.9l11.5-69.3c2.9-17.4 19.4-29.2 36.8-26.3zM187.1 192L165.8 320h95.1l21.3-128H187.1z"></path></svg>
                    <span>Spring Boot</span>
                </a><button class="nav-list-expander" aria-label="toggle items in Spring Boot category" aria-pressed="false">
                    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"></path></svg>
                </button>
</div>
<ul class="nav-list"><li id="nav-second" aria-label="Security">
                    <div class="nav-item">
                        <a href="/Spring%20Boot/Security/" class="nav-list-link nav-sh">
                            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"></path></svg>
                            <span>Security</span>
                        </a>
</div>
</li></ul>
</li>
<li id="nav-first" aria-label="Trouble Shooting">
            <div class="nav-item">
                <a href="/Trouble%20Shooting/" class="nav-list-link nav-lh">
                    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M181.3 32.4c17.4 2.9 29.2 19.4 26.3 36.8L197.8 128h95.1l11.5-69.3c2.9-17.4 19.4-29.2 36.8-26.3s29.2 19.4 26.3 36.8L357.8 128H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H347.1L325.8 320H384c17.7 0 32 14.3 32 32s-14.3 32-32 32H315.1l-11.5 69.3c-2.9 17.4-19.4 29.2-36.8 26.3s-29.2-19.4-26.3-36.8l9.8-58.7H155.1l-11.5 69.3c-2.9 17.4-19.4 29.2-36.8 26.3s-29.2-19.4-26.3-36.8L90.2 384H32c-17.7 0-32-14.3-32-32s14.3-32 32-32h68.9l21.3-128H64c-17.7 0-32-14.3-32-32s14.3-32 32-32h68.9l11.5-69.3c2.9-17.4 19.4-29.2 36.8-26.3zM187.1 192L165.8 320h95.1l21.3-128H187.1z"></path></svg>
                    <span>Trouble Shooting</span>
                </a>
</div>
</li>
<li id="nav-first" aria-label="Home">
            <div class="nav-item">
                <a href="/" class="nav-list-link nav-lh">
                    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M181.3 32.4c17.4 2.9 29.2 19.4 26.3 36.8L197.8 128h95.1l11.5-69.3c2.9-17.4 19.4-29.2 36.8-26.3s29.2 19.4 26.3 36.8L357.8 128H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H347.1L325.8 320H384c17.7 0 32 14.3 32 32s-14.3 32-32 32H315.1l-11.5 69.3c-2.9 17.4-19.4 29.2-36.8 26.3s-29.2-19.4-26.3-36.8l9.8-58.7H155.1l-11.5 69.3c-2.9 17.4-19.4 29.2-36.8 26.3s-29.2-19.4-26.3-36.8L90.2 384H32c-17.7 0-32-14.3-32-32s14.3-32 32-32h68.9l21.3-128H64c-17.7 0-32-14.3-32-32s14.3-32 32-32h68.9l11.5-69.3c2.9-17.4 19.4-29.2 36.8-26.3zM187.1 192L165.8 320h95.1l21.3-128H187.1z"></path></svg>
                    <span>Home</span>
                </a>
</div>
</li>
</ul>
</nav>
        
        <div id="contact">
            <hr>
            <h3>Contact</h3>
            <ul class="contact-list">
                
                    <li><a aria-label="My Github" href="https://github.com/Gimini-3">
                        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3 .3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5 .3-6.2 2.3zm44.2-1.7c-2.9 .7-4.9 2.6-4.6 4.9 .3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3 .7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3 .3 2.9 2.3 3.9 1.6 1 3.6 .7 4.3-.7 .7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3 .7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3 .7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
                    </a></li>
                
                
                    <li><a aria-label="My Email" href="mailto:gimin1463@naver.com">
                        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"></path></svg>
                    </a></li>
                
                
                
                    <li><a aria-label="My Instagram" href="https://www.instagram.com/gimin0226">
                        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg>
                    </a></li>
                
                
                
                    <li><a aria-label="My LinkedIn" href="https://www.linkedin.com/in/g-m-627b33392">
                        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
                    </a></li>
                
            </ul>
            <hr>
            <span>
                Copyright © 2024 | <a href="https://github.com/byanko55/jekyll-theme-satellite">Yankos</a>
            </span>
        </div>
    </div>
</div>
<div class="sidebar sidebar-right">
    <div class="tools">
        <button id="btn-brightness" aria-label="brightness-button">
            <svg class="ico-dark" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512"><path d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"></path></svg>
            <svg class="ico-light" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"></path></svg>
        </button>
        <button id="btn-search" aria-label="search-button">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"></path></svg>
        </button>
    </div>
<div class="toc">
        <span class="toc-header">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512"><path d="M0 48V487.7C0 501.1 10.9 512 24.3 512c5 0 9.9-1.5 14-4.4L192 400 345.7 507.6c4.1 2.9 9 4.4 14 4.4c13.4 0 24.3-10.9 24.3-24.3V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48z"></path></svg>
            Contents
        </span>
        <div class="toc-board"></div>
    </div>
</div>

        <div id="post">
            <div class="inner-header">
                <span class="dot" style="background-color: #F86158;"></span>
                <span class="dot" style="background-color: #FBBF2D;"></span>
                <span class="dot" style="background-color: #2ACB45;"></span>
            </div>
            <div class="inner-content">
                <div class="category-tree">
<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 576 512"><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"></path></svg>
    <p>
                <a href="/">Home</a>
                &gt;
            <a href="/Architecture/">Architecture</a>
                &gt;
            <a href="/Architecture/Domain%20Design/">Domain Design</a>
                &gt;
            
                
                    [ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기
                
            </p>
</div>
                
                    <div class="post-header">
    <div class="thumbnail">
        <div class="transbox">
            
                <span class="post-title">[ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기</span>
            
            <div class="post-info">
                
                    <a class="info-box category-box" href="/Architecture">
                        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 576 512"><path d="M384 480h48c11.4 0 21.9-6 27.6-15.9l112-192c5.8-9.9 5.8-22.1 .1-32.1S555.5 224 544 224H144c-11.4 0-21.9 6-27.6 15.9L48 357.1V96c0-8.8 7.2-16 16-16H181.5c4.2 0 8.3 1.7 11.3 4.7l26.5 26.5c21 21 49.5 32.8 79.2 32.8H416c8.8 0 16 7.2 16 16v32h48V160c0-35.3-28.7-64-64-64H298.5c-17 0-33.3-6.7-45.3-18.7L226.7 50.7c-12-12-28.3-18.7-45.3-18.7H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H87.7 384z"></path></svg>
                        <span>Architecture</span>
                    </a>
                
                <span class="info-box">
                    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><path d="M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192h80v56H48V192zm0 104h80v64H48V296zm128 0h96v64H176V296zm144 0h80v64H320V296zm80-48H320V192h80v56zm0 160v40c0 8.8-7.2 16-16 16H320V408h80zm-128 0v56H176V408h96zm-144 0v56H64c-8.8 0-16-7.2-16-16V408h80zM272 248H176V192h96v56z"></path></svg>
                    <span>
                            2025-12-12
                        
                    </span>
                </span>
                
                <a class="info-box" id="comments-counter">
                    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4l0 0 0 0 0 0 0 0 .3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg>
                    <span id="num-comments">-</span>
                </a>
            </div>
        </div>
    </div>
</div>
<div class="tag-box">
<span class="tag theme-0" contentid="DDD">
            DDD
        </span><span class="tag theme-1" contentid="domain-driven design">
            domain-driven design
        </span><span class="tag theme-2" contentid="domain design">
            domain design
        </span><span class="tag theme-0" contentid="architecture">
            architecture
        </span><span class="tag theme-1" contentid="aggregate">
            aggregate
        </span><span class="tag theme-2" contentid="domain model">
            domain model
        </span><span class="tag theme-0" contentid="entity">
            entity
        </span>
</div>
<main>
    <h1 id="oneco-ddd-도메인-설계-시리즈-part-2-dailycontent-애그리거트-뜯어보기">[ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기</h1>

<blockquote>
  <p>Part 1에서는 “왜 DailyContent를 애그리거트 루트로 두었는가”를 개념적으로 정리했다면,<br>
이번 Part 2는 <strong>실제 코드 한 파일(DailyContent.java)(애그리거트)을 기준으로 설계 의도와 동작 방식을 해부</strong>하는 글이다.</p>

</blockquote>

<hr>

<h2 id="0-도메인-구조--전체-코드-원문">0. 도메인 구조 &amp; 전체 코드 원문</h2>
<p><img src="img/img.png" alt="img.png" loading="lazy"><br>
먼저 기준이 되는 <code class="language-plaintext highlighter-rouge">DailyContent</code> 애그리거트 전체 코드이다.</p>

<p>(프로젝트를 진행하며 수정되거나 추가될 수도 있다. 수정된 코드는 깃허브에서 확인할 수 있다.)</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@NoArgsConstructor</span><span class="o">(</span><span class="n">access</span> <span class="o">=</span> <span class="nc">AccessLevel</span><span class="o">.</span><span class="na">PROTECTED</span><span class="o">)</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"daily_contents"</span><span class="o">,</span>
    <span class="n">uniqueConstraints</span> <span class="o">=</span> <span class="o">{</span>
        <span class="nd">@UniqueConstraint</span><span class="o">(</span>
            <span class="n">name</span><span class="o">=</span> <span class="s">"uk_category_day_sequence"</span><span class="o">,</span>
            <span class="n">columnNames</span> <span class="o">=</span> <span class="o">{</span><span class="s">"category_id"</span><span class="o">,</span> <span class="s">"day_sequence"</span><span class="o">}</span>
        <span class="o">)</span>
    <span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DailyContent</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">CategoryId</span> <span class="n">categoryId</span><span class="o">;</span>

    <span class="nd">@Convert</span><span class="o">(</span><span class="n">converter</span> <span class="o">=</span> <span class="nc">DaySequenceConverter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">DaySequence</span> <span class="n">daySequence</span><span class="o">;</span>

    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">ContentDescription</span> <span class="n">description</span><span class="o">;</span>

    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">Keyword</span> <span class="n">keyword</span><span class="o">;</span>

    <span class="nd">@Embedded</span>
    <span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"url"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"image_url"</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">))</span>
    <span class="kd">private</span> <span class="nc">ImageFile</span> <span class="n">imageFile</span><span class="o">;</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"daily_content_id"</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">NewsItem</span><span class="o">&gt;</span> <span class="n">newsItems</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"daily_content_id"</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Quiz</span><span class="o">&gt;</span> <span class="n">quizzes</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">private</span> <span class="nf">DailyContent</span><span class="o">(</span>
        <span class="nc">CategoryId</span> <span class="n">categoryId</span><span class="o">,</span>
        <span class="nc">DaySequence</span> <span class="n">daySequence</span><span class="o">,</span>
        <span class="nc">Keyword</span> <span class="n">keyword</span><span class="o">,</span>
        <span class="nc">ContentDescription</span> <span class="n">description</span><span class="o">,</span>
        <span class="nc">ImageFile</span> <span class="n">imageFile</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">categoryId</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"categoryId는 null일 수 없습니다."</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">daySequence</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"daySequence는 null일 수 없습니다."</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">keyword</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"keyword는 null일 수 없습니다."</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">description</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"description는 null일 수 없습니다."</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">imageFile</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"imageFile는 null일 수 없습니다."</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">categoryId</span> <span class="o">=</span> <span class="n">categoryId</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">daySequence</span> <span class="o">=</span> <span class="n">daySequence</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">keyword</span> <span class="o">=</span> <span class="n">keyword</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">imageFile</span> <span class="o">=</span> <span class="n">imageFile</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">DailyContent</span> <span class="nf">create</span><span class="o">(</span>
        <span class="nc">CategoryId</span> <span class="n">categoryId</span><span class="o">,</span>
        <span class="nc">DaySequence</span> <span class="n">daySequence</span><span class="o">,</span>
        <span class="nc">Keyword</span> <span class="n">keyword</span><span class="o">,</span>
        <span class="nc">ContentDescription</span> <span class="n">description</span><span class="o">,</span>
        <span class="nc">ImageFile</span> <span class="n">imageFile</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">DailyContent</span><span class="o">(</span><span class="n">categoryId</span><span class="o">,</span> <span class="n">daySequence</span><span class="o">,</span> <span class="n">keyword</span><span class="o">,</span> <span class="n">description</span><span class="o">,</span> <span class="n">imageFile</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateDescription</span><span class="o">(</span><span class="nc">ContentDescription</span> <span class="n">newDescription</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">newDescription</span><span class="o">,</span> <span class="s">"newDescription은 null일 수 없습니다."</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="n">newDescription</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeSummary</span><span class="o">(</span><span class="nc">String</span> <span class="n">newSummary</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">description</span><span class="o">.</span><span class="na">withSummary</span><span class="o">(</span><span class="n">newSummary</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeTitle</span><span class="o">(</span><span class="nc">String</span> <span class="n">newTitle</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">description</span><span class="o">.</span><span class="na">withTitle</span><span class="o">(</span><span class="n">newTitle</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeBodyText</span><span class="o">(</span><span class="nc">String</span> <span class="n">newBodyText</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">description</span><span class="o">.</span><span class="na">withBodyText</span><span class="o">(</span><span class="n">newBodyText</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">NewsItem</span><span class="o">&gt;</span> <span class="nf">getNewsItems</span><span class="o">(){</span>
        <span class="k">return</span> <span class="nc">List</span><span class="o">.</span><span class="na">copyOf</span><span class="o">(</span><span class="n">newsItems</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateNewsTitle</span><span class="o">(</span><span class="nc">NewsItemOrder</span> <span class="n">order</span><span class="o">,</span> <span class="nc">String</span> <span class="n">newTitle</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">NewsItem</span> <span class="n">target</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">newsItems</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">item</span><span class="o">.</span><span class="na">getNewsItemOrder</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">order</span><span class="o">))</span>
            <span class="o">.</span><span class="na">findFirst</span><span class="o">()</span>
            <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">(</span><span class="s">"해당 순번의 뉴스가 존재하지 않습니다."</span><span class="o">));</span>

        <span class="n">target</span><span class="o">.</span><span class="na">changeTitle</span><span class="o">(</span><span class="n">newTitle</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateQuizQuestion</span><span class="o">(</span><span class="nc">QuestionOrder</span> <span class="n">order</span><span class="o">,</span> <span class="nc">String</span> <span class="n">newQuestion</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Quiz</span> <span class="n">target</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">quizzes</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">q</span> <span class="o">-&gt;</span> <span class="n">q</span><span class="o">.</span><span class="na">getQuestionOrder</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">order</span><span class="o">))</span>
            <span class="o">.</span><span class="na">findFirst</span><span class="o">()</span>
            <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">(</span><span class="s">"해당 순번의 퀴즈가 존재하지 않습니다."</span><span class="o">));</span>

        <span class="n">target</span><span class="o">.</span><span class="na">changeQuestion</span><span class="o">(</span><span class="n">newQuestion</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">NewsItem</span> <span class="nf">addNewsItem</span><span class="o">(</span>
        <span class="nc">String</span> <span class="n">title</span><span class="o">,</span>
        <span class="nc">NewsItemOrder</span> <span class="n">order</span><span class="o">,</span>
        <span class="nc">WebLink</span> <span class="n">link</span><span class="o">,</span>
        <span class="nc">ImageFile</span> <span class="n">imageFile</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="s">"title은 null일 수 없다."</span><span class="o">);</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">order</span><span class="o">,</span> <span class="s">"order는 null일 수 없다."</span><span class="o">);</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">imageFile</span><span class="o">,</span> <span class="s">"imageFile은 null일 수 없다."</span><span class="o">);</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">link</span><span class="o">,</span> <span class="s">"link는 null일 수 없다."</span><span class="o">);</span>

        <span class="n">validateNewsOrderDuplicate</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>

        <span class="nc">NewsItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">NewsItem</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">link</span><span class="o">,</span> <span class="n">order</span><span class="o">,</span> <span class="n">imageFile</span><span class="o">);</span>
        <span class="n">newsItems</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeNewsItem</span><span class="o">(</span> <span class="nc">NewsItem</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">item</span> <span class="o">==</span><span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"뉴스 아이템은 null일 수 없습니다."</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">newsItems</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeNewsItemByOrder</span><span class="o">(</span><span class="nc">NewsItemOrder</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">removed</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">newsItems</span><span class="o">.</span><span class="na">removeIf</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">item</span><span class="o">.</span><span class="na">getNewsItemOrder</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">order</span><span class="o">));</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">removed</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"삭제할 뉴스가 존재하지 않습니다."</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeKeyword</span><span class="o">(</span><span class="nc">Keyword</span> <span class="n">newKeyword</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">newKeyword</span><span class="o">,</span> <span class="s">"newKeyword는 null일 수 없다."</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">keyword</span> <span class="o">=</span> <span class="n">newKeyword</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeImage</span><span class="o">(</span><span class="nc">ImageFile</span> <span class="n">newImageFile</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">newImageFile</span><span class="o">,</span> <span class="s">"newImageFile는 null일 수 없다."</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">imageFile</span> <span class="o">=</span> <span class="n">newImageFile</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isSameCategory</span><span class="o">(</span><span class="nc">CategoryId</span> <span class="n">other</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">categoryId</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">other</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Quiz</span><span class="o">&gt;</span> <span class="nf">getQuizzes</span><span class="o">(){</span>
        <span class="k">return</span> <span class="nc">List</span><span class="o">.</span><span class="na">copyOf</span><span class="o">(</span><span class="n">quizzes</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Quiz</span> <span class="nf">addQuiz</span><span class="o">(</span>
        <span class="nc">String</span> <span class="n">question</span><span class="o">,</span>
        <span class="nc">QuestionOrder</span> <span class="n">order</span><span class="o">,</span>
        <span class="nc">QuizOptions</span> <span class="n">options</span><span class="o">,</span>
        <span class="nc">AnswerIndex</span> <span class="n">answerIndex</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">question</span><span class="o">,</span> <span class="s">"question은 null일 수 없다."</span><span class="o">);</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">order</span><span class="o">,</span> <span class="s">"order는 null일 수 없다."</span><span class="o">);</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">options</span><span class="o">,</span> <span class="s">"options는 null일 수 없다."</span><span class="o">);</span>
        <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">answerIndex</span><span class="o">,</span> <span class="s">"answerIndex는 null일 수 없다."</span><span class="o">);</span>

        <span class="n">validateQuizOrderDuplicate</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>

        <span class="nc">Quiz</span> <span class="n">quiz</span> <span class="o">=</span> <span class="nc">Quiz</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">question</span><span class="o">,</span> <span class="n">order</span><span class="o">,</span> <span class="n">options</span><span class="o">,</span> <span class="n">answerIndex</span><span class="o">);</span>
        <span class="n">quizzes</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">quiz</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">quiz</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeQuiz</span><span class="o">(</span> <span class="nc">Quiz</span> <span class="n">quiz</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">quiz</span> <span class="o">==</span><span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"퀴즈는 null일 수 없습니다."</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">quizzes</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">quiz</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeQuizByOrder</span><span class="o">(</span><span class="nc">QuestionOrder</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">removed</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">quizzes</span><span class="o">.</span><span class="na">removeIf</span><span class="o">(</span><span class="n">q</span> <span class="o">-&gt;</span> <span class="n">q</span><span class="o">.</span><span class="na">getQuestionOrder</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">order</span><span class="o">));</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">removed</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"삭제할 퀴즈가 존재하지 않습니다: "</span> <span class="o">+</span> <span class="n">order</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">validateNewsOrderDuplicate</span><span class="o">(</span><span class="nc">NewsItemOrder</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">newsItems</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">anyMatch</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span><span class="o">.</span><span class="na">getNewsItemOrder</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">order</span><span class="o">)))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"동일한 뉴스 순번이 이미 존재합니다: "</span> <span class="o">+</span> <span class="n">order</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">validateQuizOrderDuplicate</span><span class="o">(</span><span class="nc">QuestionOrder</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">quizzes</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">anyMatch</span><span class="o">(</span><span class="n">q</span> <span class="o">-&gt;</span> <span class="n">q</span><span class="o">.</span><span class="na">getQuestionOrder</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">order</span><span class="o">)))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"동일한 퀴즈 순번이 이미 존재합니다: "</span> <span class="o">+</span> <span class="n">order</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>이제 이 코드를 “애그리거트 루트로서 어떤 책임을 갖고 있는지” 관점에서 단계적으로 살펴본다.</p>

<hr>

<h2 id="1-애그리거트-entity-table-유니크-제약">1. 애그리거트 @Entity, @Table, 유니크 제약</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@NoArgsConstructor</span><span class="o">(</span><span class="n">access</span> <span class="o">=</span> <span class="nc">AccessLevel</span><span class="o">.</span><span class="na">PROTECTED</span><span class="o">)</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"daily_contents"</span><span class="o">,</span>
<span class="n">uniqueConstraints</span> <span class="o">=</span> <span class="o">{</span>
<span class="nd">@UniqueConstraint</span><span class="o">(</span>
<span class="n">name</span><span class="o">=</span> <span class="s">"uk_category_day_sequence"</span><span class="o">,</span>
<span class="n">columnNames</span> <span class="o">=</span> <span class="o">{</span><span class="s">"category_id"</span><span class="o">,</span> <span class="s">"day_sequence"</span><span class="o">}</span>
<span class="o">)</span>
<span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DailyContent</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
</code></pre></div></div>

<p>여기에는 세 가지 의도가 들어 있다.</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@Entity</code> + <code class="language-plaintext highlighter-rouge">@Table(name = "daily_contents")</code></p>

    <p>도메인 이름은 <code class="language-plaintext highlighter-rouge">DailyContent</code>지만, 테이블은 <code class="language-plaintext highlighter-rouge">daily_contents</code> 로 복수형 snake_case를 사용했다.</p>

    <p>스키마만 열어봐도 “여러 개의 DailyContent가 모여 있는 테이블”이라는 사실을 직관적으로 알 수 있게 하기 위한 선택이다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@NoArgsConstructor(access = PROTECTED)</code></p>

    <p>JPA가 리플렉션으로 인스턴스를 만들 수 있도록 기본 생성자는 열어두되,</p>

    <p>애플리케이션 코드에서 무분별하게 <code class="language-plaintext highlighter-rouge">new DailyContent()</code> 하지 못하도록 보호한다.</p>

    <p>실제 생성 경로는 아래에서 볼 <code class="language-plaintext highlighter-rouge">create(...)</code> 팩토리로만 강제된다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@UniqueConstraint(category_id, day_sequence)</code></p>

    <p><code class="language-plaintext highlighter-rouge">(카테고리, 일차)</code> 조합이 유일해야 한다는 비즈니스 규칙을 DB까지 내리는 선택이다.</p>

    <ul>
      <li>도메인 규칙: “카테고리 A의 3일차 DailyContent는 단 하나만 존재한다.”</li>
      <li>이 규칙을 RDB의 유니크 키로 함께 보강함으로써, 애플리케이션 버그나 동시성 이슈로 인한 중복 생성도 차단한다.</li>
    </ul>
  </li>
</ol>

<p>DDD 관점에서 보면, <strong>애그리거트 루트의 핵심 불변식 하나를 데이터베이스에 위임</strong>한 형태이다.</p>

<hr>

<h2 id="2-하루치-학습-경험을-표현하는-값-객체들">2. 하루치 학습 경험을 표현하는 값 객체들</h2>

<p>DailyContent는 원시 타입을 거의 사용하지 않고 대부분을 VO로 감싼다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Embedded</span>
<span class="kd">private</span> <span class="nc">CategoryId</span> <span class="n">categoryId</span><span class="o">;</span>

<span class="nd">@Convert</span><span class="o">(</span><span class="n">converter</span> <span class="o">=</span> <span class="nc">DaySequenceConverter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">DaySequence</span> <span class="n">daySequence</span><span class="o">;</span>

<span class="nd">@Embedded</span>
<span class="kd">private</span> <span class="nc">ContentDescription</span> <span class="n">description</span><span class="o">;</span>

<span class="nd">@Embedded</span>
<span class="kd">private</span> <span class="nc">Keyword</span> <span class="n">keyword</span><span class="o">;</span>

<span class="nd">@Embedded</span>
<span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"url"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"image_url"</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">))</span>
<span class="kd">private</span> <span class="nc">ImageFile</span> <span class="n">imageFile</span><span class="o">;</span>

</code></pre></div></div>

<p>각 VO의 역할은 다음과 같다.</p>

<h3 id="21-categoryid">2.1 CategoryId</h3>

<ul>
  <li>단순 <code class="language-plaintext highlighter-rouge">Long categoryId</code> 대신 <code class="language-plaintext highlighter-rouge">CategoryId</code> VO 사용.</li>
  <li>값 생성 시 “양수인지, null 아닌지”를 VO 내부에서 보장한다.</li>
  <li>다른 애그리거트(카테고리)와 연결되는 키이기도 하기 때문에, 의미 있는 타입으로 감싸 검증 포인트를 한 곳에 모았다.</li>
</ul>

<h3 id="22-daysequence">2.2 DaySequence</h3>

<ul>
  <li>“이 카테고리에서 몇 번째 날인지(1일차, 2일차…)” 를 표현하는 타입.</li>
  <li>
<code class="language-plaintext highlighter-rouge">AbstractSequence</code>를 상속하여 “1 이상”이라는 공통 규칙을 재사용한다.</li>
  <li>JPA 매핑은 <code class="language-plaintext highlighter-rouge">@Convert(converter = DaySequenceConverter.class)</code> 를 통해 INT 한 컬럼으로 저장한다.</li>
  <li>도메인 코드에서는 항상 <code class="language-plaintext highlighter-rouge">DaySequence</code> 타입으로 다룸으로써, 날짜/일차 개념이 섞이지 않도록 한다.</li>
</ul>

<h3 id="23-contentdescription">2.3 ContentDescription</h3>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">title</code>, <code class="language-plaintext highlighter-rouge">summary</code>, <code class="language-plaintext highlighter-rouge">bodyText</code> 를 하나의 VO로 묶었다.</li>
  <li>길이 제한, 공백 허용 여부, null 불가 등의 검증은 모두 VO 생성 시점에 수행된다.</li>
  <li>DailyContent는 “설명 자체가 null인지” 정도만 체크하고, 문자열 유효성은 VO에 위임한다.</li>
</ul>

<h3 id="24-keyword">2.4 Keyword</h3>

<ul>
  <li>오늘의 핵심 키워드(예: “기준금리”, “양적완화”)를 표현한다.</li>
  <li>최대 길이, 공백 제거(trim), 빈 문자열 방지 등의 검증을 VO 내부에서 수행한다.</li>
</ul>

<h3 id="25-imagefile">2.5 ImageFile</h3>

<ul>
  <li>대표 이미지에 대한 url을 표현하는 VO.</li>
  <li>지금은 url 한 개만 갖지만, 나중에 “허용 도메인, 허용 확장자, 규격” 같은 정책을 추가할 때도 이 타입 안에서 일관되게 처리할 수 있다.</li>
</ul>

<p><strong>요약</strong></p>

<p>DailyContent는 “하루치 학습 경험”을 구성하는 요소들을 전부 <strong>의미 있는 타입</strong>(VO)으로 받고,</p>

<p>각 VO는 “자기 값은 자기 책임으로 검증하는” 구조를 가진다.</p>

<p>애그리거트 루트는 값의 조합과 일관성에 집중하고, 값 자체의 정합성은 VO 레벨에서 담당한다.</p>

<hr>

<h2 id="3-newsitem--quiz-컬렉션-애그리거트-내부-엔티티-관리">3. NewsItem / Quiz 컬렉션: 애그리거트 내부 엔티티 관리</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@OneToMany</span><span class="o">(</span><span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"daily_content_id"</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">NewsItem</span><span class="o">&gt;</span> <span class="n">newsItems</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

<span class="nd">@OneToMany</span><span class="o">(</span><span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"daily_content_id"</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Quiz</span><span class="o">&gt;</span> <span class="n">quizzes</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

</code></pre></div></div>

<p>여기에는 애그리거트 생명주기와 관련된 설계 의도가 들어 있다.</p>

<p>부모 자체를 삭제하면 cascade, 컬렉션에서 자식만 빼면 orphanRemoval이 동작한다.</p>

<h3 id="31-cascade--cascadetypeall">3.1 cascade = CascadeType.ALL</h3>

<ul>
  <li>DailyContent를 저장/삭제할 때, 관련된 NewsItem/Quiz도 함께 저장/삭제된다.</li>
  <li>즉, “하루치 콘텐츠”의 생명주기에 뉴스·퀴즈를 묶는다.</li>
  <li>DDD 용어로, NewsItem과 Quiz는 <strong>같은 애그리거트에 속한 엔티티</strong>이며, 루트인 DailyContent가 이들의 생명주기를 관리한다.</li>
</ul>

<h3 id="32-orphanremoval--true">3.2 orphanRemoval = true</h3>

<ul>
  <li>DailyContent에서 제거된 NewsItem/Quiz는 DB에서도 자동 삭제된다.</li>
  <li>즉, “부모(DailyContent)와의 연결이 끊긴 자식(NewsItem/Quiz)은 자동으로 DB에서 DELETE 하겠다” 라는 옵션이다.
    <ul>
      <li>컬렉션에서 분리된 자식 엔티티를 그냥 메모리에서만 떼어내는 게 아니라, DB에서도 같이 지워주는 옵션</li>
    </ul>
  </li>
  <li>관리 UI에서 DailyContent의 뉴스 한 개를 제거하면, JPA가 해당 NewsItem을 고아 객체로 판단하여 DB에서 DELETE까지 자동으로 해준다.</li>
</ul>

<h3 id="33-단방향-onetomany--fk">3.3 단방향 OneToMany + FK</h3>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">@JoinColumn(name = "daily_content_id")</code> 를 통해 자식 테이블에 FK를 두되,</li>
  <li>자식 엔티티(NewsItem, Quiz) 쪽에는 <code class="language-plaintext highlighter-rouge">@ManyToOne</code> 필드가 없다.</li>
  <li>즉, 도메인 모델 상으로는 “DailyContent → 자식들” 단방향만 존재한다.</li>
</ul>

<p>이는 “부모(하루치 경험)를 중심으로만 모델을 다루겠다”는 의도에 가깝다.</p>

<p>조회 최적화가 필요해지면, 별도의 조회용 쿼리/리포지토리를 두는 방식으로 보완할 수 있다.</p>

<hr>

<h2 id="4-생성과-팩토리-생성-시점에-불변식-잠그기">4. 생성과 팩토리: 생성 시점에 불변식 잠그기</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="nf">DailyContent</span><span class="o">(</span>
    <span class="nc">CategoryId</span> <span class="n">categoryId</span><span class="o">,</span>
    <span class="nc">DaySequence</span> <span class="n">daySequence</span><span class="o">,</span>
    <span class="nc">Keyword</span> <span class="n">keyword</span><span class="o">,</span>
    <span class="nc">ContentDescription</span> <span class="n">description</span><span class="o">,</span>
    <span class="nc">ImageFile</span> <span class="n">imageFile</span>
<span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">categoryId</span> <span class="o">=</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">categoryId</span><span class="o">,</span> <span class="s">"categoryId는 null일 수 없습니다."</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">daySequence</span> <span class="o">=</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">daySequence</span><span class="o">,</span> <span class="s">"daySequence는 null일 수 없습니다."</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">keyword</span> <span class="o">=</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">keyword</span><span class="o">,</span> <span class="s">"keyword는 null일 수 없습니다."</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">description</span><span class="o">,</span> <span class="s">"description은 null일 수 없습니다."</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">imageFile</span> <span class="o">=</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">imageFile</span><span class="o">,</span> <span class="s">"imageFile는 null일 수 없습니다."</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="nc">DailyContent</span> <span class="nf">create</span><span class="o">(</span>
    <span class="nc">CategoryId</span> <span class="n">categoryId</span><span class="o">,</span>
    <span class="nc">DaySequence</span> <span class="n">daySequence</span><span class="o">,</span>
    <span class="nc">Keyword</span> <span class="n">keyword</span><span class="o">,</span>
    <span class="nc">ContentDescription</span> <span class="n">description</span><span class="o">,</span>
    <span class="nc">ImageFile</span> <span class="n">imageFile</span>
<span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">DailyContent</span><span class="o">(</span><span class="n">categoryId</span><span class="o">,</span> <span class="n">daySequence</span><span class="o">,</span> <span class="n">keyword</span><span class="o">,</span> <span class="n">description</span><span class="o">,</span> <span class="n">imageFile</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div></div>

<h3 id="설계-포인트">설계 포인트</h3>

<ol>
  <li>생성자는 <code class="language-plaintext highlighter-rouge">private</code>, 생성 경로는 <code class="language-plaintext highlighter-rouge">create(...)</code> 로만
    <ul>
      <li>JPA용 기본 생성자 외에,</li>
    </ul>
  </li>
</ol>

<p>애플리케이션 코드에서 사용할 생성 경로를 정적 팩토리 하나로 통일했다.</p>

<ul>
  <li>생성 시 검증 로직이 늘어나도 팩토리 내부만 수정하면 되고, 호출부는 그대로 유지된다.
    <ol>
      <li>루트에서 하는 검증 vs VO에서 하는 검증</li>
    </ol>
  </li>
  <li>루트는 “필수 구성요소가 null이 아닌가?”를 체크한다.</li>
  <li>VO는 “값 자체가 유효한가?(양수인지, 길이 제한 안쪽인지 등)”를 체크한다.</li>
  <li>이 레이어 분리를 통해, 생성 시점의 책임을 명확하게 나눌 수 있다.</li>
</ul>

<h3 id="서비스-계층에서의-사용-예">서비스 계층에서의 사용 예</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DailyContentService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">DailyContentRepository</span> <span class="n">dailyContentRepository</span><span class="o">;</span>

    <span class="nd">@Transactional</span>
    <span class="kd">public</span> <span class="nc">DailyContent</span> <span class="nf">createDailyContent</span><span class="o">(</span><span class="nc">CreateDailyContentCommand</span> <span class="n">cmd</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">DailyContent</span> <span class="n">dailyContent</span> <span class="o">=</span> <span class="nc">DailyContent</span><span class="o">.</span><span class="na">create</span><span class="o">(</span>
            <span class="nc">CategoryId</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">categoryId</span><span class="o">()),</span>
            <span class="k">new</span> <span class="nf">DaySequence</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">daySequence</span><span class="o">()),</span>
            <span class="nc">Keyword</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">keyword</span><span class="o">()),</span>
            <span class="nc">ContentDescription</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">title</span><span class="o">(),</span> <span class="n">cmd</span><span class="o">.</span><span class="na">summary</span><span class="o">(),</span> <span class="n">cmd</span><span class="o">.</span><span class="na">body</span><span class="o">()),</span>
            <span class="nc">ImageFile</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">imageUrl</span><span class="o">())</span>
        <span class="o">);</span>

        <span class="k">return</span> <span class="n">dailyContentRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">dailyContent</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>서비스는 다음 역할만 가진다.</p>

<ul>
  <li>원시 입력값 → VO 변환</li>
  <li>애그리거트 생성/저장 오케스트레이션</li>
</ul>

<p><strong>도메인 규칙(필수 값, 조합의 의미, VO 유효성)은 모두 루트와 VO 내부에 몰아둔 구조</strong>다.</p>

<hr>

<h2 id="5-설명키워드이미지-변경-vo-교체-기반의-변경">5. 설명/키워드/이미지 변경: VO 교체 기반의 변경</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateDescription</span><span class="o">(</span><span class="nc">ContentDescription</span> <span class="n">newDescription</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">newDescription</span><span class="o">,</span> <span class="s">"newDescription은 null일 수 없습니다."</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="n">newDescription</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeSummary</span><span class="o">(</span><span class="nc">String</span> <span class="n">newSummary</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">description</span><span class="o">.</span><span class="na">withSummary</span><span class="o">(</span><span class="n">newSummary</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeTitle</span><span class="o">(</span><span class="nc">String</span> <span class="n">newTitle</span><span class="o">){</span>
    <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">description</span><span class="o">.</span><span class="na">withTitle</span><span class="o">(</span><span class="n">newTitle</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeBodyText</span><span class="o">(</span><span class="nc">String</span> <span class="n">newBodyText</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">description</span><span class="o">.</span><span class="na">withBodyText</span><span class="o">(</span><span class="n">newBodyText</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeKeyword</span><span class="o">(</span><span class="nc">Keyword</span> <span class="n">newKeyword</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">newKeyword</span><span class="o">,</span> <span class="s">"newKeyword는 null일 수 없다."</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">keyword</span> <span class="o">=</span> <span class="n">newKeyword</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeImage</span><span class="o">(</span><span class="nc">ImageFile</span> <span class="n">newImageFile</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">newImageFile</span><span class="o">,</span> <span class="s">"newImageFile는 null일 수 없다."</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">imageFile</span> <span class="o">=</span> <span class="n">newImageFile</span><span class="o">;</span>
<span class="o">}</span>

</code></pre></div></div>

<h3 id="핵심-아이디어">핵심 아이디어</h3>

<ol>
  <li>VO를 직접 수정하지 않고 <strong>새 VO로 교체</strong>한다.
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">withSummary</code>, <code class="language-plaintext highlighter-rouge">withTitle</code> 등은 새로운 <code class="language-plaintext highlighter-rouge">ContentDescription</code> 인스턴스를 만들어 반환한다.</li>
      <li>기존 VO는 불변 객체로 취급되며, 변경은 항상 “새 객체로 교체” 형태로 일어난다.</li>
    </ul>
  </li>
  <li>루트는 “null 방지”까지만 책임
    <ul>
      <li>null 방지는 DailyContent가,</li>
      <li>문자열 길이/형식 검증 등은 VO가 맡는다.</li>
      <li>단, String의 null/공백/길이 규칙은 <code class="language-plaintext highlighter-rouge">ContentDescription</code> 안에서만 관리한다.</li>
    </ul>
  </li>
</ol>

<p>서비스 계층에서의 사용 예는 다음과 같이 단순하다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateDailyContentSummary</span><span class="o">(</span><span class="nc">Long</span> <span class="n">dailyContentId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">newSummary</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">DailyContent</span> <span class="n">dc</span> <span class="o">=</span> <span class="n">dailyContentRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">dailyContentId</span><span class="o">)</span>
        <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NotFoundException</span><span class="o">(</span><span class="s">"DailyContent not found"</span><span class="o">));</span>

    <span class="n">dc</span><span class="o">.</span><span class="na">changeSummary</span><span class="o">(</span><span class="n">newSummary</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div></div>

<hr>

<h2 id="6-컬렉션-보호와-도메인-메서드-기반-조작">6. 컬렉션 보호와 도메인 메서드 기반 조작</h2>

<h3 id="61-읽기-전용-뷰-제공">6.1. 읽기 전용 뷰 제공</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">NewsItem</span><span class="o">&gt;</span> <span class="nf">getNewsItems</span><span class="o">(){</span>
    <span class="k">return</span> <span class="nc">List</span><span class="o">.</span><span class="na">copyOf</span><span class="o">(</span><span class="n">newsItems</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Quiz</span><span class="o">&gt;</span> <span class="nf">getQuizzes</span><span class="o">(){</span>
    <span class="k">return</span> <span class="nc">List</span><span class="o">.</span><span class="na">copyOf</span><span class="o">(</span><span class="n">quizzes</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">List.copyOf(...)</code> 를 사용해 방어적 복사 + 불변 리스트를 반환한다.</li>
  <li>외부 코드에서 <code class="language-plaintext highlighter-rouge">getNewsItems().add(...)</code> 같은 조작을 시도하면 <code class="language-plaintext highlighter-rouge">UnsupportedOperationException</code> 이 발생한다.</li>
  <li>즉, <strong>구조 변경은 반드시 애그리거트 루트의 메서드를 거치도록 강제</strong>한 것이다.</li>
</ul>

<h3 id="62-추가삭제는-루트-메서드를-통해서만">6.2. 추가/삭제는 루트 메서드를 통해서만</h3>

<p>뉴스 추가:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">NewsItem</span> <span class="nf">addNewsItem</span><span class="o">(</span>
    <span class="nc">String</span> <span class="n">title</span><span class="o">,</span>
    <span class="nc">NewsItemOrder</span> <span class="n">order</span><span class="o">,</span>
    <span class="nc">WebLink</span> <span class="n">link</span><span class="o">,</span>
    <span class="nc">ImageFile</span> <span class="n">imageFile</span>
<span class="o">)</span> <span class="o">{</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="s">"title은 null일 수 없다."</span><span class="o">);</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">order</span><span class="o">,</span> <span class="s">"order는 null일 수 없다."</span><span class="o">);</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">imageFile</span><span class="o">,</span> <span class="s">"imageFile은 null일 수 없다."</span><span class="o">);</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">link</span><span class="o">,</span> <span class="s">"link는 null일 수 없다."</span><span class="o">);</span>

    <span class="n">validateNewsOrderDuplicate</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>

    <span class="nc">NewsItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">NewsItem</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">title</span><span class="o">,</span> <span class="n">link</span><span class="o">,</span> <span class="n">order</span><span class="o">,</span> <span class="n">imageFile</span><span class="o">);</span>
    <span class="n">newsItems</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
<span class="o">}</span>

</code></pre></div></div>

<p>퀴즈 추가:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Quiz</span> <span class="nf">addQuiz</span><span class="o">(</span>
    <span class="nc">String</span> <span class="n">question</span><span class="o">,</span>
    <span class="nc">QuestionOrder</span> <span class="n">order</span><span class="o">,</span>
    <span class="nc">QuizOptions</span> <span class="n">options</span><span class="o">,</span>
    <span class="nc">AnswerIndex</span> <span class="n">answerIndex</span>
<span class="o">)</span> <span class="o">{</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">question</span><span class="o">,</span> <span class="s">"question은 null일 수 없다."</span><span class="o">);</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">order</span><span class="o">,</span> <span class="s">"order는 null일 수 없다."</span><span class="o">);</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">options</span><span class="o">,</span> <span class="s">"options는 null일 수 없다."</span><span class="o">);</span>
    <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">answerIndex</span><span class="o">,</span> <span class="s">"answerIndex는 null일 수 없다."</span><span class="o">);</span>

    <span class="n">validateQuizOrderDuplicate</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>

    <span class="nc">Quiz</span> <span class="n">quiz</span> <span class="o">=</span> <span class="nc">Quiz</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">question</span><span class="o">,</span> <span class="n">order</span><span class="o">,</span> <span class="n">options</span><span class="o">,</span> <span class="n">answerIndex</span><span class="o">);</span>
    <span class="n">quizzes</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">quiz</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">quiz</span><span class="o">;</span>
<span class="o">}</span>

</code></pre></div></div>

<p>중복 순번 검증:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kt">void</span> <span class="nf">validateNewsOrderDuplicate</span><span class="o">(</span><span class="nc">NewsItemOrder</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">newsItems</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">anyMatch</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span><span class="o">.</span><span class="na">getNewsItemOrder</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">order</span><span class="o">)))</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"동일한 뉴스 순번이 이미 존재합니다: "</span> <span class="o">+</span> <span class="n">order</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">void</span> <span class="nf">validateQuizOrderDuplicate</span><span class="o">(</span><span class="nc">QuestionOrder</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">quizzes</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">anyMatch</span><span class="o">(</span><span class="n">q</span> <span class="o">-&gt;</span> <span class="n">q</span><span class="o">.</span><span class="na">getQuestionOrder</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">order</span><span class="o">)))</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"동일한 퀴즈 순번이 이미 존재합니다: "</span> <span class="o">+</span> <span class="n">order</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>설계 의도는 명확하다.</p>

<ul>
  <li>“뉴스/퀴즈 추가”는 반드시 루트의 도메인 메서드를 통과해야 한다.</li>
  <li>그 안에서
    <ul>
      <li>필수 값 null 방지</li>
      <li>순번(order) 중복 방지</li>
      <li>
        <p>내부 엔티티 생성 규칙</p>

        <p>를 모두 처리한다.</p>
      </li>
    </ul>
  </li>
</ul>

<p>서비스에서는 다음과 같이 사용하게 된다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">addNewsToDailyContent</span><span class="o">(</span><span class="nc">Long</span> <span class="n">dailyContentId</span><span class="o">,</span> <span class="nc">AddNewsCommand</span> <span class="n">cmd</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">DailyContent</span> <span class="n">dc</span> <span class="o">=</span> <span class="n">dailyContentRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">dailyContentId</span><span class="o">)</span>
        <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NotFoundException</span><span class="o">(</span><span class="s">"DailyContent not found"</span><span class="o">));</span>

    <span class="n">dc</span><span class="o">.</span><span class="na">addNewsItem</span><span class="o">(</span>
        <span class="n">cmd</span><span class="o">.</span><span class="na">title</span><span class="o">(),</span>
        <span class="k">new</span> <span class="nf">NewsItemOrder</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">order</span><span class="o">()),</span>
        <span class="nc">WebLink</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">url</span><span class="o">()),</span>
        <span class="nc">ImageFile</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">imageUrl</span><span class="o">())</span>
    <span class="o">);</span>
<span class="o">}</span>

</code></pre></div></div>

<p>외부에서 <code class="language-plaintext highlighter-rouge">newsItems.add(...)</code> 를 직접 호출할 수 없기 때문에,</p>

<p>애그리거트 불변식을 우회해서 깨뜨리기 어렵다.</p>

<hr>

<h2 id="7-서비스-계층에서-본-하루치-경험-생성-흐름">7. 서비스 계층에서 본 “하루치 경험” 생성 흐름</h2>

<p>DailyContent를 기준으로 “하루치 학습 경험 + 뉴스 + 퀴즈” 를 한 번에 생성하는 흐름을 예로 들면 다음과 같다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="nc">Long</span> <span class="nf">createWithNewsAndQuiz</span><span class="o">(</span><span class="nc">CreateDailyContentAllInOneCommand</span> <span class="n">cmd</span><span class="o">)</span> <span class="o">{</span>

    <span class="nc">DailyContent</span> <span class="n">dc</span> <span class="o">=</span> <span class="nc">DailyContent</span><span class="o">.</span><span class="na">create</span><span class="o">(</span>
        <span class="nc">CategoryId</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">categoryId</span><span class="o">()),</span>
        <span class="k">new</span> <span class="nf">DaySequence</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">daySequence</span><span class="o">()),</span>
        <span class="nc">Keyword</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">keyword</span><span class="o">()),</span>
        <span class="nc">ContentDescription</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">title</span><span class="o">(),</span> <span class="n">cmd</span><span class="o">.</span><span class="na">summary</span><span class="o">(),</span> <span class="n">cmd</span><span class="o">.</span><span class="na">body</span><span class="o">()),</span>
        <span class="nc">ImageFile</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">imageUrl</span><span class="o">())</span>
    <span class="o">);</span>

    <span class="k">for</span> <span class="o">(</span><span class="nc">CreateNewsCommand</span> <span class="n">n</span> <span class="o">:</span> <span class="n">cmd</span><span class="o">.</span><span class="na">newsList</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">dc</span><span class="o">.</span><span class="na">addNewsItem</span><span class="o">(</span>
            <span class="n">n</span><span class="o">.</span><span class="na">title</span><span class="o">(),</span>
            <span class="k">new</span> <span class="nf">NewsItemOrder</span><span class="o">(</span><span class="n">n</span><span class="o">.</span><span class="na">order</span><span class="o">()),</span>
            <span class="nc">WebLink</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">n</span><span class="o">.</span><span class="na">url</span><span class="o">()),</span>
            <span class="nc">ImageFile</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">n</span><span class="o">.</span><span class="na">imageUrl</span><span class="o">())</span>
        <span class="o">);</span>
    <span class="o">}</span>

    <span class="k">for</span> <span class="o">(</span><span class="nc">CreateQuizCommand</span> <span class="n">q</span> <span class="o">:</span> <span class="n">cmd</span><span class="o">.</span><span class="na">quizList</span><span class="o">())</span> <span class="o">{</span>
        <span class="nc">QuizOptions</span> <span class="n">options</span> <span class="o">=</span> <span class="nc">QuizOptions</span><span class="o">.</span><span class="na">ofTexts</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">options</span><span class="o">());</span>
        <span class="nc">AnswerIndex</span> <span class="n">answerIndex</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnswerIndex</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">answerIndex</span><span class="o">());</span>

        <span class="n">dc</span><span class="o">.</span><span class="na">addQuiz</span><span class="o">(</span>
            <span class="n">q</span><span class="o">.</span><span class="na">question</span><span class="o">(),</span>
            <span class="k">new</span> <span class="nf">QuestionOrder</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">order</span><span class="o">()),</span>
            <span class="n">options</span><span class="o">,</span>
            <span class="n">answerIndex</span>
        <span class="o">);</span>
    <span class="o">}</span>

    <span class="nc">DailyContent</span> <span class="n">saved</span> <span class="o">=</span> <span class="n">dailyContentRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">dc</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">saved</span><span class="o">.</span><span class="na">getId</span><span class="o">();</span>
<span class="o">}</span>

</code></pre></div></div>

<p>관심사의 분리는 이렇게 정리할 수 있다.</p>

<ul>
  <li>서비스 계층
    <ul>
      <li>트랜잭션 관리</li>
      <li>유스케이스 오케스트레이션(“하루치 경험 + 뉴스 + 퀴즈를 한 번에 구성”)</li>
    </ul>
  </li>
  <li>애그리거트 루트(DailyContent)
    <ul>
      <li>하루치 경험의 일관성, 불변식, 내부 엔티티 관리</li>
    </ul>
  </li>
  <li>VO
    <ul>
      <li>자기 값의 유효성 검증</li>
    </ul>
  </li>
  <li>
    <p>Part 2에서는 DailyContent.java 한 파일을 기준으로,</p>

    <p>“하루치 학습 경험” 애그리거트가 어떤 책임을 갖고 있는지 살펴봤다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@Entity</code>/<code class="language-plaintext highlighter-rouge">@Table</code>/유니크 제약으로</p>

    <p>“카테고리별 N일차는 하나”라는 불변식을 DB까지 끌어내리고,</p>
  </li>
  <li>
    <p>CategoryId, DaySequence, ContentDescription, Keyword, ImageFile 같은 값 객체들로</p>

    <p>원시 타입 대신 “의미 있는 타입 + 자체 검증”을 사용했다.</p>
  </li>
  <li>
    <p>NewsItem/Quiz는 같은 애그리거트 안에 속한 엔티티로 두고,</p>

    <p><code class="language-plaintext highlighter-rouge">cascade + orphanRemoval + 단방향 OneToMany</code> 로 DailyContent 생명주기에 종속시켰다.</p>
  </li>
  <li>
    <p>생성/수정/추가/삭제는 전부 DailyContent의 도메인 메서드를 통해 이루어지며,</p>

    <p>서비스 계층은 “VO 변환 + 애그리거트 조합 + 트랜잭션”에만 집중한다.</p>
  </li>
</ul>

    <!-- see https://giscus.app/ -->
    <div class="giscus" id="giscus" style="margin: 4rem auto;"></div>
    <div id="related-box">
        <span>
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M278.5 215.6L23 471c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l74.8-74.8c7.4 4.6 15.3 8.2 23.8 10.5C200.3 452.8 270 454.5 338 409.4c12.2-8.1 5.8-25.4-8.8-25.4l-16.1 0c-5.1 0-9.2-4.1-9.2-9.2c0-4.1 2.7-7.6 6.5-8.8l97.7-29.3c3.4-1 6.4-3.1 8.4-6.1c4.4-6.4 8.6-12.9 12.6-19.6c6.2-10.3-1.5-23-13.5-23l-38.6 0c-5.1 0-9.2-4.1-9.2-9.2c0-4.1 2.7-7.6 6.5-8.8l80.9-24.3c4.6-1.4 8.4-4.8 10.2-9.3C494.5 163 507.8 86.1 511.9 36.8c.8-9.9-3-19.6-10-26.6s-16.7-10.8-26.6-10C391.5 7 228.5 40.5 137.4 131.6C57.3 211.7 56.7 302.3 71.3 356.4c2.1 7.9 12 9.6 17.8 3.8L253.6 195.8c6.2-6.2 16.4-6.2 22.6 0c5.4 5.4 6.1 13.6 2.2 19.8z"></path></svg>
            You May Also Like
        </span>
        <ul id="related-posts"></ul>
    </div>
</main>
<div class="top-arrow">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512"><path d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"></path></svg>
</div>

                
            </div>
        </div>
        <div id="search">
    <div class="wave"></div>
    <div class="wave"></div>
    <div class="wave"></div>

    <div class="search-box">
        <mark>Touch background to close</mark>
        <div class="input-box">
            <input id="search-input" type="search" tabindex="1" spellcheck="false" placeholder="Search...">
            <button id="btn-clear">
                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512"><path d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"></path></svg>
            </button>
        </div>
        <ul id="search-result"></ul>
    </div>
</div>
    </body>
    <script defer src="/assets/js/background.js"></script>
<script defer src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }

    gtag('js', new Date());
    gtag('config', '');
</script>
    
        <script src="/assets/js/post.js"></script>
        <link rel="preload" href="/assets/css/highlight.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/assets/css/highlight.min.css"></noscript>
        <script defer src="/assets/js/highlight.min.js"></script>
    
    <script src="/assets/js/common.js"></script>

    <script defer>
    var posts = [];

    

        posts.push({
            'title'    : "Index",
            'path'     : "Architecture > Domain Design",
            'type'     : "category",
            'tags'     : "",
            'url'      : "/Architecture/Domain%20Design/index.html",
            'image'    : "/assets/img/thumbnail/empty.jpg",
            'date'     : "1900-01-01"
        });
    

        posts.push({
            'title'    : "Index",
            'path'     : "Architecture > System Design",
            'type'     : "category",
            'tags'     : "",
            'url'      : "/Architecture/System%20Design/index.html",
            'image'    : "/assets/img/thumbnail/empty.jpg",
            'date'     : "1900-01-01"
        });
    

        posts.push({
            'title'    : "Index",
            'path'     : "Architecture > data-modeling-erd",
            'type'     : "category",
            'tags'     : "",
            'url'      : "/Architecture/data-modeling-erd/index.html",
            'image'    : "/assets/img/thumbnail/empty.jpg",
            'date'     : "1900-01-01"
        });
    

        posts.push({
            'title'    : "Index",
            'path'     : "Architecture",
            'type'     : "category",
            'tags'     : "",
            'url'      : "/Architecture/index.html",
            'image'    : "/assets/img/thumbnail/empty.jpg",
            'date'     : "1900-01-01"
        });
    

        posts.push({
            'title'    : "Index",
            'path'     : "Architecture > security-auth",
            'type'     : "category",
            'tags'     : "",
            'url'      : "/Architecture/security-auth/index.html",
            'image'    : "/assets/img/thumbnail/empty.jpg",
            'date'     : "1900-01-01"
        });
    

        posts.push({
            'title'    : "Index",
            'path'     : "Java",
            'type'     : "category",
            'tags'     : "",
            'url'      : "/Java/index.html",
            'image'    : "/assets/img/thumbnail/empty.jpg",
            'date'     : "1900-01-01"
        });
    

        posts.push({
            'title'    : "Index",
            'path'     : "Spring Boot > Security",
            'type'     : "category",
            'tags'     : "",
            'url'      : "/Spring%20Boot/Security/index.html",
            'image'    : "/assets/img/thumbnail/empty.jpg",
            'date'     : "1900-01-01"
        });
    

        posts.push({
            'title'    : "Index",
            'path'     : "Spring Boot",
            'type'     : "category",
            'tags'     : "",
            'url'      : "/Spring%20Boot/index.html",
            'image'    : "/assets/img/thumbnail/empty.jpg",
            'date'     : "1900-01-01"
        });
    

        posts.push({
            'title'    : "Index",
            'path'     : "Trouble Shooting",
            'type'     : "category",
            'tags'     : "",
            'url'      : "/Trouble%20Shooting/index.html",
            'image'    : "/assets/img/thumbnail/empty.jpg",
            'date'     : "1900-01-01"
        });
    

        posts.push({
            'title'    : "Index",
            'path'     : "",
            'type'     : "category",
            'tags'     : "",
            'url'      : "/index.html",
            'image'    : "/assets/img/thumbnail/empty.jpg",
            'date'     : "1900-01-01"
        });
    

        posts.push({
            'title'    : "[Java Concurrency] Thread.start()와 Thread 객체의 모니터 락 획득 과정",
            'path'     : "Java",
            'type'     : "post",
            'tags'     : "java, Concurrency, monitor lock, thread, synchronized, multi thread",
            'url'      : "/Java/thread-monitor-lock-1.html",
            'image'    : "/assets/img/thumbnail/thread-monitor-lock-1.png",
            'date'     : "2025-09-26"
        });
    

        posts.push({
            'title'    : "[Java Concurrency] 모니터 락과 wait/notifyAll로 턴 스케줄러 구현하기",
            'path'     : "Java",
            'type'     : "post",
            'tags'     : "java, Concurrency, monitor lock, wait-notifyAll",
            'url'      : "/Java/monitor-lock-1.html",
            'image'    : "/assets/img/thumbnail/monitor-lock-1.png",
            'date'     : "2025-09-30"
        });
    

        posts.push({
            'title'    : "[Java Multithreading] Part 1 – Thread.start() vs run() : 자바 코드 + 간단한 흐름 비교",
            'path'     : "Java",
            'type'     : "post",
            'tags'     : "java, concurrency, thread, start, run, jvm",
            'url'      : "/Java/java-thread-start-part1-start-vs-run-code-and-flow.html",
            'image'    : "/assets/img/thumbnail/thread-start.png",
            'date'     : "2025-10-02"
        });
    

        posts.push({
            'title'    : "[Java Multithreading] Part 2 – Thread.start() 뒤에서 일어나는 일: registerNatives ~ JVM_StartThread ~ JavaThread",
            'path'     : "Java",
            'type'     : "post",
            'tags'     : "java, concurrency, thread, start, run, jvm",
            'url'      : "/Java/java-thread-start-part2-start0-jvm-startthread-javathread.html",
            'image'    : "/assets/img/thumbnail/thread-start.png",
            'date'     : "2025-10-03"
        });
    

        posts.push({
            'title'    : "[Java Multithreading] Part 3 – JVM이 OS 스레드를 만드는 과정: JavaThread, os::create_thread, pthread_create, glibc, clone()",
            'path'     : "Java",
            'type'     : "post",
            'tags'     : "java, concurrency, thread, start, run, jvm",
            'url'      : "/Java/java-thread-start-part3-os-create-thread-pthread-glibc-clone.html",
            'image'    : "/assets/img/thumbnail/thread-start.png",
            'date'     : "2025-10-04"
        });
    

        posts.push({
            'title'    : "[Java Multithreading] Part 4 – 새로운 스레드가 자바 run()에 도달하기까지: thread_native_entry → JavaThread::run → thread_entry → Thread.run()",
            'path'     : "Java",
            'type'     : "post",
            'tags'     : "java, concurrency, thread, start, run, jvm",
            'url'      : "/Java/java-thread-start-part4-thread-entry-to-run.html",
            'image'    : "/assets/img/thumbnail/thread-start.png",
            'date'     : "2025-10-04"
        });
    

        posts.push({
            'title'    : "[Java Multithreading] 마지막 글 - 스레드 관점에서 한눈에 정리: new → start → run → 종료 후 상태",
            'path'     : "Java",
            'type'     : "post",
            'tags'     : "java, concurrency, thread, start, run, jvm",
            'url'      : "/Java/java-thread-start-part5-thread-lifecycle-summary.html",
            'image'    : "/assets/img/thumbnail/thread-start.png",
            'date'     : "2025-10-06"
        });
    

        posts.push({
            'title'    : "[Firebase/Java] Firestore ApiFuture와 Java Future, 그리고 Reactor Mono까지 – 비동기 흐름 뜯어보기",
            'path'     : "Java",
            'type'     : "post",
            'tags'     : "java, firestore, apifuture, future, listenablefuture, reactor, mono, async, concurrency",
            'url'      : "/Java/firestore-apifuture-future-mono-async-flow.html",
            'image'    : "/assets/img/thumbnail/firestore-apifuture-future-mono-async-flow.png",
            'date'     : "2025-10-25"
        });
    

        posts.push({
            'title'    : "[시스템 설계] 하루 한 번 알림을 “누락 없이” 보내기 위한 Redis 큐 &amp; 워커 설계",
            'path'     : "Architecture > System Design",
            'type'     : "post",
            'tags'     : "redis, worker, at-least-once-notification, spring schedule, blmove, redis-queue-blmove-idempotency",
            'url'      : "/Architecture/System%20Design/at-least-once-notification-redis-queue-blmove-idempotency.html",
            'image'    : "/assets/img/thumbnail/at-least-once-notification-redis-queue-blmove-idempotency.png",
            'date'     : "2025-11-03"
        });
    

        posts.push({
            'title'    : "카카오 OAuth 로그인 흐름 이해하기: JS SDK + Authorization Code 플로우",
            'path'     : "Architecture > security-auth",
            'type'     : "post",
            'tags'     : "springboot, spring-security, oauth2, kakao, login, diagram",
            'url'      : "/Architecture/security-auth/2025-11-30-kakao-login.html",
            'image'    : "/assets/img/thumbnail/2025-11-30-kakao-login.png",
            'date'     : "2025-11-30"
        });
    

        posts.push({
            'title'    : "[Docker Troubleshooting] Spring Redis UnknownHostException 해결기: Spring 앱과 Redis의 외부 네트워크와 DNS 스코프 문제",
            'path'     : "Trouble Shooting",
            'type'     : "post",
            'tags'     : "docker, docker-compose, redis, spring, networking, dns, ec2, devops, troubleshooting",
            'url'      : "/Trouble%20Shooting/docker-redis-network-dns.html",
            'image'    : "/assets/img/thumbnail/docker-redis-network-dns.png",
            'date'     : "2025-12-08"
        });
    

        posts.push({
            'title'    : "[Troubleshooting] Nginx로 HTTPS→HTTP 프록시 구성해 Mixed Content 해결하기 (도메인 없이 nip.io 사용)",
            'path'     : "Trouble Shooting",
            'type'     : "post",
            'tags'     : "trouble shooting, nginx, https, nip.io, docker, devops, ssl, ec2, aws",
            'url'      : "/Trouble%20Shooting/nginx-https-without-domain-nip-io.html",
            'image'    : "/assets/img/thumbnail/nginx-https-without-domain-nip-io.png",
            'date'     : "2025-12-09"
        });
    

        posts.push({
            'title'    : "[ONECO DDD 도메인 설계 시리즈 Part 1] DailyContent 애그리거트 설계 스토리",
            'path'     : "Architecture > Domain Design",
            'type'     : "post",
            'tags'     : "DDD, domain-driven design, domain design, architecture, aggregate, domain model, entity, value object",
            'url'      : "/Architecture/Domain%20Design/oneco-ddd-dailycontent-1.html",
            'image'    : "/assets/img/thumbnail/oneco-ddd-dailycontent.png",
            'date'     : "2025-12-11"
        });
    

        posts.push({
            'title'    : "[ONECO DDD 도메인 설계 시리즈 Part 2] DailyContent 애그리거트 뜯어보기",
            'path'     : "Architecture > Domain Design",
            'type'     : "post",
            'tags'     : "DDD, domain-driven design, domain design, architecture, aggregate, domain model, entity",
            'url'      : "/Architecture/Domain%20Design/oneco-ddd-dailycontent-2.html",
            'image'    : "/assets/img/thumbnail/oneco-ddd-dailycontent.png",
            'date'     : "2025-12-12"
        });
    

    searchPost(posts);

    
        searchRelated(posts);
    
</script>
    <script type="module">
        import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
        document.addEventListener("DOMContentLoaded", function () {
            mermaid.initialize({ startOnLoad: true });
        });
    </script>
</html>
